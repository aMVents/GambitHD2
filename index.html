<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GAMBIT — HD2 Strategic Operations</title>

  <!-- Google Fonts: Rajdhani (display) + Share Tech Mono (data/numbers) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Share+Tech+Mono&display=swap"
    rel="stylesheet"
  />

  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- ====================================================
       HEADER — sticky operations bar
       ==================================================== -->
  <header id="header">
    <div class="header-inner">

      <!-- Brand -->
      <div class="brand">
        <div class="brand-icon">&#9876;</div>
        <div>
          <div class="brand-name">GAMBIT ANALYSIS TOOL</div>
          <div class="brand-sub">HD2 STRATEGIC OPERATIONS CENTER</div>
        </div>
      </div>

      <!-- Live war statistics (populated by JS) -->
      <div id="war-stats"></div>

      <!-- Controls -->
      <div class="header-right">
        <div id="last-updated">CONNECTING...</div>
        <button id="refresh-btn" class="btn-refresh" onclick="refresh()">
          &#8635; REFRESH
        </button>
      </div>

    </div>

    <!-- Tab navigation -->
    <nav class="tab-nav">
      <button class="tab-btn active" data-tab="gambit" onclick="switchTab('gambit')">
        &#9876; GAMBIT ANALYSIS
      </button>
      <button class="tab-btn scout-tab" data-tab="scout" onclick="switchTab('scout')">
        ◎ STRATEGIC SCOUT
      </button>
      <button class="tab-btn guide-tab" data-tab="guide" onclick="switchTab('guide')">
        ? WHAT IS A GAMBIT
      </button>
    </nav>

  </header>

  <!-- ====================================================
       MAIN CONTENT
       ==================================================== -->
  <main>

    <!-- Loading state -->
    <div id="loading">
      <div class="spinner"></div>
      <div class="loading-text">ESTABLISHING UPLINK TO SUPER EARTH...</div>
    </div>

    <!-- Error state -->
    <div id="error-screen" class="hidden">
      <div class="error-icon">&#9888;</div>
      <div id="error-msg">UPLINK FAILED</div>
      <button class="btn-retry" onclick="refresh()">RETRY CONNECTION</button>
    </div>

    <!-- Main content (revealed after first successful load) -->
    <div id="content" class="hidden">

      <!-- ══════════════════════════════════════════════════
           TAB: GAMBIT ANALYSIS
           ══════════════════════════════════════════════════ -->
      <div id="tab-gambit" class="tab-panel">

        <!-- ── MAJOR ORDERS ───────────────────────────────── -->
        <section class="section">
          <div class="section-header">
            <h2 class="section-title">MAJOR ORDERS</h2>
            <span id="orders-count" class="count-badge">0</span>
          </div>
          <div id="orders-container" class="orders-container"></div>
        </section>

        <!-- ── GAMBIT ANALYSIS ────────────────────────────── -->
        <section class="section gambit-section">
          <div class="section-header">
            <h2 class="section-title gambit-title">&#9876; GAMBIT ANALYSIS</h2>
            <span id="gambit-count" class="count-badge">0</span>
            <span class="gambit-hint">AUTO-DETECTED STRATEGIC OPPORTUNITIES</span>
          </div>
          <div id="gambit-container" class="gambit-container"></div>
        </section>

        <!-- ── LIBERATION / DEFENSE CAMPAIGNS ────────────── -->
        <div class="campaigns-grid">

          <!-- Liberation Campaigns -->
          <section class="section">
            <div class="section-header">
              <h2 class="section-title liberation-title">LIBERATION CAMPAIGNS</h2>
              <span id="liberation-count" class="count-badge">0</span>
            </div>
            <div id="liberation-container" class="planets-container"></div>
          </section>

          <!-- Defense Campaigns -->
          <section class="section">
            <div class="section-header">
              <h2 class="section-title defense-title">DEFENSE CAMPAIGNS</h2>
              <span id="defense-count" class="count-badge">0</span>
            </div>
            <div id="defense-container" class="planets-container"></div>
          </section>

        </div>

      </div><!-- /#tab-gambit -->

      <!-- ══════════════════════════════════════════════════
           TAB: STRATEGIC SCOUT
           ══════════════════════════════════════════════════ -->
      <div id="tab-scout" class="tab-panel hidden">

        <!-- Scout intro banner -->
        <div class="scout-intro">
          <div class="scout-intro-question">What planets could we start fighting that would benefit a defense?</div>
          <p class="scout-intro-body">
            The Gambit Analysis tab covers planets already being fought over. Strategic Scout goes one step further —
            it scans the full galaxy for <strong>enemy-held planets with supply-line connections to active defense campaigns
            that have no active liberation yet.</strong> These are untapped opportunities. Starting a liberation on any
            of these planets creates a new Gambit: if we liberate it in time, the connected defense is saved automatically.
          </p>
        </div>

        <section class="section">
          <div class="section-header">
            <h2 class="section-title scout-title">◎ STRATEGIC SCOUT</h2>
            <span id="scout-count" class="count-badge">0</span>
            <span class="gambit-hint">UNTAPPED ATTACK VECTORS LINKED TO ACTIVE DEFENSES</span>
          </div>
          <div id="scout-container" class="scout-container"></div>
        </section>

      </div><!-- /#tab-scout -->

      <!-- ══════════════════════════════════════════════════
           TAB: WHAT IS A GAMBIT
           ══════════════════════════════════════════════════ -->
      <div id="tab-guide" class="tab-panel hidden">
        <div class="guide-page">

          <!-- ── Hero ─────────────────────────────────────── -->
          <div class="guide-hero">
            <div class="guide-hero-icon">&#9876;</div>
            <h1 class="guide-hero-title">WHAT IS A GAMBIT?</h1>
            <p class="guide-hero-sub">A high-risk, high-reward strategic play that can win two battles for the price of one.</p>
          </div>

          <!-- ── The Chicken Game ───────────────────────────── -->
          <section class="guide-section">
            <h2 class="guide-section-title">THE CHICKEN ANALOGY</h2>
            <p class="guide-body">
              Imagine two cars racing head-on toward each other on a narrow road.
              The driver who <strong>swerves first</strong> is called a "chicken" — they avoided the crash, but they lost.
              The driver who <strong>doesn't swerve</strong> wins — but only if the other one blinks first.
              If <em>neither</em> swerves, they both crash.
            </p>
            <p class="guide-body">
              This is the game of <strong>Chicken</strong> — a classic game theory scenario where the winner
              is the one who commits most convincingly to not backing down.
            </p>
            <div class="guide-diagram chicken-diagram">
              <div class="chicken-side left">
                <div class="chicken-label">HELLDIVERS</div>
                <div class="chicken-car">&#9658;&#9658;&#9658;</div>
              </div>
              <div class="chicken-center">
                <div class="chicken-road-label">HEAD-ON</div>
              </div>
              <div class="chicken-side right">
                <div class="chicken-label">ENEMY</div>
                <div class="chicken-car flip">&#9668;&#9668;&#9668;</div>
              </div>
            </div>
          </section>

          <!-- ── How It Maps to HD2 ─────────────────────────── -->
          <section class="guide-section">
            <h2 class="guide-section-title">HOW THIS APPLIES TO HELLDIVERS 2</h2>
            <p class="guide-body">
              When an enemy faction attacks one of our planets, the standard response is to
              <strong>defend it directly</strong> — send Helldivers there and hold the line.
              That's swerving. It works, but you only break even. You saved what you had.
            </p>
            <p class="guide-body">
              A <strong>Gambit</strong> is the refusal to swerve. Instead of defending the planet under attack,
              Helldivers pile onto the planet <em>launching</em> the attack and liberate it.
              If the liberation succeeds before the defense fails, the attack is cancelled automatically —
              because the enemy no longer holds the planet it was attacking from.
              <strong>You win the liberation AND the defense in a single move.</strong>
            </p>
            <div class="guide-callout">
              <span class="guide-callout-icon">&#9650;</span>
              Win the source planet = cancel the attack = save the defense for free.
            </div>
          </section>

          <!-- ── Real Example ───────────────────────────────── -->
          <section class="guide-section">
            <h2 class="guide-section-title">A REAL EXAMPLE</h2>
            <p class="guide-body">
              Suppose <strong>Erata Prime</strong> (enemy-held) is launching an attack on <strong>Bore Rock</strong>
              (a planet we must defend). The standard play: send everyone to Bore Rock and defend it.
            </p>
            <p class="guide-body">
              The <strong>Gambit play</strong>: ignore Bore Rock. Attack Erata Prime instead.
              Now the enemy is in the Chicken position — their attack on Bore Rock is only possible
              while they hold Erata Prime. If we liberate Erata Prime, the Bore Rock defense
              resolves in our favour <em>instantly</em>, even if no Helldiver ever set foot there.
            </p>

            <div class="guide-diagram example-diagram">
              <div class="ex-col">
                <div class="ex-planet enemy-planet">
                  <div class="ex-planet-name">ERATA PRIME</div>
                  <div class="ex-planet-sub">ENEMY SOURCE</div>
                </div>
              </div>
              <div class="ex-arrow-col">
                <div class="ex-arrow-label">ATTACKING</div>
                <div class="ex-arrow">&#9658;&#9658;&#9658;</div>
                <div class="ex-arrow-label gambit-label-small">GAMBIT: attack here &#8593;</div>
              </div>
              <div class="ex-col">
                <div class="ex-planet defend-planet">
                  <div class="ex-planet-name">BORE ROCK</div>
                  <div class="ex-planet-sub">UNDER DEFENSE</div>
                </div>
              </div>
            </div>

            <div class="guide-outcome-row">
              <div class="guide-outcome fail">
                <div class="outcome-title">&#10007; STANDARD PLAY</div>
                <div class="outcome-body">Defend Bore Rock. Win the defense. Erata Prime stays enemy-held. You break even.</div>
              </div>
              <div class="guide-outcome win">
                <div class="outcome-title">&#9876; THE GAMBIT</div>
                <div class="outcome-body">Liberate Erata Prime. Bore Rock defense resolves automatically. You gain a planet AND save the defense.</div>
              </div>
            </div>
          </section>

          <!-- ── The Risk ───────────────────────────────────── -->
          <section class="guide-section">
            <h2 class="guide-section-title">THE RISK</h2>
            <p class="guide-body">
              A Gambit is not free. If the liberation of Erata Prime takes too long, Bore Rock falls
              before you finish — and you end up with nothing. The Gambit only works if:
            </p>
            <ul class="guide-checklist">
              <li><span class="check-icon pass">&#10003;</span> There are <strong>enough Helldivers</strong> on the liberation planet to outpace enemy regen</li>
              <li><span class="check-icon pass">&#10003;</span> The liberation can be <strong>completed before the defense timer expires</strong></li>
              <li><span class="check-icon pass">&#10003;</span> The liberation planet has <strong>meaningful progress</strong> already made (ideally 25%+)</li>
              <li><span class="check-icon fail">&#10007;</span> If any of these fail, the defense is lost and the gambit is wasted</li>
            </ul>
            <div class="guide-callout caution">
              <span class="guide-callout-icon">&#9888;</span>
              The Gambit Analysis tab calculates all of this for you — check the success % and conditions before committing.
            </div>
          </section>

          <!-- ── How to Use This Tool ───────────────────────── -->
          <section class="guide-section">
            <h2 class="guide-section-title">HOW TO USE THIS TOOL</h2>
            <div class="guide-tool-grid">
              <div class="guide-tool-card">
                <div class="guide-tool-icon">&#9876;</div>
                <div class="guide-tool-name">GAMBIT ANALYSIS</div>
                <div class="guide-tool-desc">Shows active liberation campaigns that are connected to defense campaigns via supply lines. Each card scores the gambit's success probability and tells you exactly what conditions need to be met.</div>
              </div>
              <div class="guide-tool-card">
                <div class="guide-tool-icon">◎</div>
                <div class="guide-tool-name">STRATEGIC SCOUT</div>
                <div class="guide-tool-desc">Shows enemy planets connected to active defenses that have <em>no active campaign yet</em>. Use this to find untapped targets — places where starting a liberation would create a new Gambit opportunity.</div>
              </div>
            </div>
          </section>

          <!-- ── Reading the Cards ──────────────────────────── -->
          <section class="guide-section">
            <h2 class="guide-section-title">READING THE CARDS</h2>
            <p class="guide-body">
              Every card in the Gambit Analysis tab shows a different level of strategic certainty.
              Here's what each label and indicator means.
            </p>

            <!-- Card type labels -->
            <div class="guide-legend">

              <div class="legend-item">
                <div class="legend-badge confirmed-legend">⚔ CONFIRMED ATTACK SOURCE</div>
                <div class="legend-desc">
                  The API has confirmed this planet is <strong>actively launching an attack</strong> on the connected
                  defense planet. These cards appear first and have a gold border. Liberating a confirmed
                  attack source is the most reliable way to execute a Gambit — success directly cancels the invasion.
                </div>
              </div>

              <div class="legend-item">
                <div class="legend-badge supply-legend">GAMBIT OPPORTUNITY</div>
                <div class="legend-desc">
                  This planet shares a <strong>supply line connection</strong> with an active defense campaign but
                  is not confirmed as the direct attacker. Liberating it may or may not resolve the defense —
                  treat these as <em>potential</em> gambits worth watching rather than guaranteed wins.
                </div>
              </div>

              <div class="legend-item">
                <div class="legend-badge attacking-legend">⚔ DIRECTLY ATTACKING</div>
                <div class="legend-desc">
                  Shown on the defense section of a confirmed card. The arrow on the galactic map points
                  from this liberation planet to the planet listed here — liberating it cuts off that arrow.
                </div>
              </div>

              <div class="legend-item">
                <div class="legend-badge supply-risk-legend">⚠ SUPPLY LINE AT RISK</div>
                <div class="legend-desc">
                  The liberation planet and defense planet are adjacent on the supply line graph but
                  no direct attack vector has been confirmed. The defense may still be influenced by
                  liberating this planet, but the connection is strategic rather than direct.
                </div>
              </div>

            </div>

            <!-- Resistance stat -->
            <h3 class="guide-sub-title">ENEMY RESISTANCE</h3>
            <p class="guide-body">
              Every liberation planet displays its <strong>enemy resistance</strong> in orange (e.g. <em>TERMINIDS resistance: 1.00%/hr</em>).
              This is the rate at which the enemy regenerates health on that planet — the floor your Helldivers must
              beat just to make forward progress. A planet with 4%/hr resistance needs far more sustained player
              presence than one at 1%/hr.
            </p>

            <!-- Risk tiers -->
            <h3 class="guide-sub-title">SUCCESS SCORE &amp; RISK TIERS</h3>
            <p class="guide-body">
              Each gambit card is scored 0–100 based on liberation progress, net liberation rate,
              time available vs. defense timer, and how many conditions are passing.
            </p>
            <div class="guide-tiers">
              <div class="tier-row"><span class="tier-badge optimal">OPTIMAL</span><span class="tier-desc">85–100 — Conditions are ideal. Deploy immediately.</span></div>
              <div class="tier-row"><span class="tier-badge favorable">FAVORABLE</span><span class="tier-desc">70–84 — Good odds. Your presence will tip the balance.</span></div>
              <div class="tier-row"><span class="tier-badge viable">VIABLE</span><span class="tier-desc">55–69 — Possible but needs sustained commitment.</span></div>
              <div class="tier-row"><span class="tier-badge risky">RISKY</span><span class="tier-desc">35–54 — Proceed only with a significant player surge.</span></div>
              <div class="tier-row"><span class="tier-badge critical">CRITICAL</span><span class="tier-desc">0–34 — Conditions unfavourable. Check "What Needs to Change" for specifics.</span></div>
            </div>

          </section>

        </div><!-- /.guide-page -->
      </div><!-- /#tab-guide -->

    </div><!-- /#content -->

  </main>

  <!-- ====================================================
       FOOTER
       ==================================================== -->
  <footer>
    <span class="footer-note">
      Data: <a href="https://api.helldivers2.dev" target="_blank" rel="noopener">api.helldivers2.dev</a>
      &nbsp;—&nbsp; Community API, not affiliated with Arrowhead Game Studios
    </span>
    <span class="footer-note">Auto-refreshes every 60s</span>
  </footer>

  <!-- Scripts: api → app → gambit → scout (order is important) -->
  <script src="js/api.js"></script>
  <script src="js/app.js"></script>
  <script src="js/gambit.js"></script>
  <script src="js/scout.js"></script>

</body>
</html>
